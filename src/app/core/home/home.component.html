<div class="dashboard-container">
  <!-- Sub Header row -->
  <div class="sub-header-row">
    <div class="search-box">
      <input type="text" placeholder="Enter search" [value]="searchTerm" (input)="onSearch($event)" />
    </div>
    <div class="sub-nav-actions">
      <button class="sub-btn" [class.active]="currentTab === 'all'" (click)="currentTab = 'all'">
        <mat-icon>folder</mat-icon> All
      </button>
      <button class="sub-btn" [class.active]="currentTab === 'favorites'" (click)="currentTab = 'favorites'">
        <mat-icon>star</mat-icon> Favorites
      </button>
    </div>
  </div>

  <!-- Loading State -->
  <div class="loading-state" *ngIf="isLoading" style="text-align: center; padding: 60px; color: #666">
    <mat-icon style="font-size: 36px; height: 36px; width: 36px">hourglass_empty</mat-icon>
    <p style="margin-top: 10px; font-weight: 500">Loading Modules...</p>
  </div>

  <!-- Cards Grid (Favorites View) -->
  <div class="cards-grid" *ngIf="!isLoading && currentTab === 'favorites'">
    <div class="app-card" *ngFor="let module of displayedModules" (click)="openWorkspace(module.id)">
      <div class="card-bg" [style.background]="module.bgStyle">
        <button class="close-btn" (click)="removeFavorite(module.id, $event)"><mat-icon>close</mat-icon></button>
      </div>
      <div class="card-logo">
        {{ module.logo }}
      </div>
      <div class="card-content">
        <h3 class="card-title">{{ module.name }}</h3>
        <p class="card-desc">{{ module.description }}</p>
      </div>
      <div class="card-footer">
        <button class="access-btn" (click)="$event.stopPropagation(); openWorkspace(module.id)">Request access</button>
      </div>
    </div>
  </div>

  <!-- List View (All View) -->
  <div class="list-view" *ngIf="!isLoading && currentTab === 'all'">
    <div class="list-item" *ngFor="let module of displayedModules" (click)="openWorkspace(module.id)">
      <div class="list-bg" [style.background]="module.bgStyle"></div>
      <div class="list-content">
        <h3 class="list-title">
          {{ module.name }}
          <mat-icon
            class="star-icon"
            [class.active]="favoriteIds.includes(module.id)"
            (click)="toggleFavorite(module.id, $event)"
          >
            {{ favoriteIds.includes(module.id) ? 'star' : 'star_border' }}
          </mat-icon>
        </h3>
        <p class="list-desc">{{ module.description }}</p>
      </div>
    </div>
  </div>
</div>
